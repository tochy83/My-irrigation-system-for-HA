
script:
  arrosage_generer_fichiers_zone:
    alias: Arrosage - Générer les fichiers pour une zone
    description: >-
      Script qui permet de générér les fichiers (entrées, automatisations et scripts) pour l'ajout d'une nouvelle zone en plus de celles existantes.


      Stocke également le numéro de la dernière zone créée.
    sequence:
      - action: shell_command.arrosage_generer_fichiers_zone
        response_variable: result
      - variables:
          nouveau_nombre: "{{ result.stdout | int }}"
      - action: input_number.set_value
        data:
          entity_id: input_number.nb_file_zones
          value: "{{ nouveau_nombre }}"
      - action: logbook.log
        data:
          name: "Génération des entités pour une nouvelle zone"
          message: "Fichier zone_{{ nouveau_nombre }}.yaml créé"
          entity_id: input_number.arrosage_nb_file_zones
      - action: logbook.log
        data:
          name: "Génération de l'automatisation pour une nouvelle zone"
          message: "Fichier automatisation_arrosage_zone_{{ nouveau_nombre }}.yaml créé"
          entity_id: input_number.arrosage_nb_file_zones
      - delay:
          hours: 0
          minutes: 0
          seconds: 1
          milliseconds: 0
      - action: input_number.increment
        metadata: {}
        data: {}
        target:
          entity_id: input_number.arrosage_nb_file_zones          
    mode: single